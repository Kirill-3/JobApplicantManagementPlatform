<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Applicant Profile</title>
    <link rel="stylesheet" href="/styling/IndividualProfiles.css">
    <link th:replace="fragments/header :: bootstrap-css"/>
    <link rel="stylesheet" type="text/css" href="/css/profilePageStyling.css"/>
    <script src="/javaScript/profilePageJS.js"></script>
    <script th:inline="javascript">
        const alertMessage = [[$,{alertMessage}]];
        if (alertMessage) {
            alert(alertMessage);
        }

    </script>

</head>
<body>

    <div th:replace="~{fragments/header :: header}"/>
    <h1> this is the profile page</h1>
    <form th:if="${profile != null}" th:action="@{/profile/sendEmail/{userID}(userID=${profile.getId()})}" method="post" onsubmit="showAlert()">
        <button type="submit"> Email <span th:text="${userId}"></span></button>
    </form>
    <table id="table1" class="tableClickable">
        <thead>
        <tr>
            <th th:data1-href="@{/profile/firstName}" th:data2-href="Ascending">First Name</th>
            <th th:data1-href="@{/profile/lastName}" th:data2-href="Ascending">Last Name</th>
            <th th:data-href="@{/profile/locationAscending}">Location</th>
            <th th:data-href="@{/profile/eventAttendedAscending}">Event Attended</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="profile : ${profileList}" th:data-href="@{/profile/{id}(id=${profile.getId()})}">
            <td th:text="${profile.getFirstName()}"></td>
            <td th:text="${profile.getLastName()}"></td>
            <td th:text="${profile.getLocation()}"></td>
            <td th:text="${profile.getEventAttended()}"></td>


        </tr>
        </tbody>
    </table>



    <div th:if="${profile != null}" class="profile-container">
    <div class = "profile-details">
        <h2>Personal Details</h2>
        <table class="tableApplicant">
            <tr>
                <th>First Name</th>
                <td th:text="${profile.firstName}"></td>
            </tr>
            <tr>
                <th>Last Name</th>
                <td th:text="${profile.lastName}"></td>
            </tr>
            <tr>
                <th>Location</th>
                <td th:text="${profile.location}"></td>
            </tr>
            <tr>
                <th>Email</th>
                <td th:text="${profile.email}"></td>
            </tr>
            <tr>
                <th>Phone Number</th>
                <td th:text="${profile.phoneNumber != null ? profile.phoneNumber : 'N/A'}"></td>
            </tr>

        </table>
        <br>

        <h2>Applicant Experience</h2>
        <table class="tableApplicant">
            <tr>
                <th>Current Position</th>
                <td th:text="${profile.jobDetails?.currentPosition != null ? profile.jobDetails.currentPosition : 'N/A'}"></td>
            </tr>
            <tr>
                <th>Status</th>
                <td th:text="${profile.jobDetails?.status != null ? profile.jobDetails.status : 'N/A'}"></td>
            </tr>
            <tr>
                <th>Skills</th>
                <td th:text="${profile.skill != null ? profile.skill : 'N/A'}"></td>
            </tr>
            <tr>
                <th>Event Attended</th>
                <td th:text="${profile.eventAttended}"></td>
            </tr>
        </table>

        <br>

        <h2>Applicant Preferences</h2>

        <table class="tableApplicant">
            <tr>
                <th>Subscribed to newsletter?</th>
                <td th:text="${profile.preferences?.subscribeToNewsletter} ? 'Yes' : 'No'"></td>
            </tr>
            <tr>
                <th>Subscribed to bulletins?</th>
                <td th:text="${profile.preferences?.subscribeToBulletins} ? 'Yes' : 'No'"></td>
            </tr>
            <tr>
                <th>Subscribed to job updates?</th>
                <td th:text="${profile.preferences?.subscribeToJobUpdates} ? 'Yes' : 'No'"></td>
            </tr>
        </table>

        <a th:href="@{/profile}">Back to Profiles</a>

    </div>

    <div class = resume-section>
        <h2>Applicant CV/Resume</h2>
        <form th:action="@{/profile/uploadCV/{userID}(userID=${profile.getId()})}" method="post" enctype="multipart/form-data">
            <label for="cvUpload">Select CV (PDF only):</label>
            <input type="file" id="cvUpload" name="cvUpload" accept="application/pdf" required>
            <button type="submit">Upload CV</button>
        </form>

    </div>

</div>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer-links}"></div>
<div th:replace="~{fragments/footer :: bootstrap-js}"></div>
</body>
</html>
